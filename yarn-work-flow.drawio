<mxfile host="app.diagrams.net" modified="2020-12-02T23:33:50.031Z" agent="5.0 (Macintosh; Intel Mac OS X 10_12_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.83 Safari/537.36" etag="-aNxXsuiK5yJ4czzSIDf" version="13.10.4" type="github" pages="2">
  <diagram id="ADyf2BumLdzopdTtbGqv" name="Page-1">
    <mxGraphModel dx="783" dy="431" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="yNt7iZRtLh1xZD_xEbhY-1" value="" style="endArrow=classic;html=1;dashed=1;strokeColor=#FF0000;curved=1;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="60" y="60" as="sourcePoint" />
            <mxPoint x="170" y="60" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="yNt7iZRtLh1xZD_xEbhY-4" value="Rpc" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="yNt7iZRtLh1xZD_xEbhY-1" vertex="1" connectable="0">
          <mxGeometry x="-0.3818" y="2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="yNt7iZRtLh1xZD_xEbhY-8" style="edgeStyle=orthogonalEdgeStyle;curved=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;dashed=1;strokeColor=#FF0000;" parent="1" source="yNt7iZRtLh1xZD_xEbhY-2" target="yNt7iZRtLh1xZD_xEbhY-3" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="yNt7iZRtLh1xZD_xEbhY-2" value="Client" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="50" y="120" width="50" height="30" as="geometry" />
        </mxCell>
        <mxCell id="yNt7iZRtLh1xZD_xEbhY-10" style="edgeStyle=orthogonalEdgeStyle;curved=1;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;strokeColor=#000000;" parent="1" source="yNt7iZRtLh1xZD_xEbhY-3" target="yNt7iZRtLh1xZD_xEbhY-11" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="500" y="135" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="yNt7iZRtLh1xZD_xEbhY-3" value="ClientRMService.submitApplication()" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="140" y="118.75" width="200" height="32.5" as="geometry" />
        </mxCell>
        <mxCell id="yNt7iZRtLh1xZD_xEbhY-6" value="" style="endArrow=classic;html=1;dashed=1;curved=1;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="60" y="80" as="sourcePoint" />
            <mxPoint x="170" y="80" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="yNt7iZRtLh1xZD_xEbhY-7" value="Local" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="yNt7iZRtLh1xZD_xEbhY-6" vertex="1" connectable="0">
          <mxGeometry x="-0.3818" y="2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="yNt7iZRtLh1xZD_xEbhY-12" style="edgeStyle=orthogonalEdgeStyle;curved=1;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;strokeColor=#000000;" parent="1" source="yNt7iZRtLh1xZD_xEbhY-11" target="yNt7iZRtLh1xZD_xEbhY-13" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="490" y="220" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="yNt7iZRtLh1xZD_xEbhY-11" value="RMAppManager.submitApplication()" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="380" y="118.75" width="220" height="31.25" as="geometry" />
        </mxCell>
        <mxCell id="yNt7iZRtLh1xZD_xEbhY-19" style="edgeStyle=orthogonalEdgeStyle;curved=1;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;strokeColor=#000000;" parent="1" source="yNt7iZRtLh1xZD_xEbhY-13" target="yNt7iZRtLh1xZD_xEbhY-17" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="yNt7iZRtLh1xZD_xEbhY-13" value="创建 RMAppImpl" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="440" y="180" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="yNt7iZRtLh1xZD_xEbhY-14" value="&lt;div style=&quot;text-align: left&quot;&gt;&lt;div&gt;1.将该应用放入 Map 集合&lt;/div&gt;&lt;div&gt;2.创建资源请求&lt;/div&gt;&lt;div&gt;3.验证资源请求是否合理&lt;/div&gt;&lt;div&gt;4.内部会创建 RMAppImpl 的状态机，初始状态是 NEW&lt;/div&gt;&lt;/div&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="549.84" y="165" width="320.16" height="60" as="geometry" />
        </mxCell>
        <mxCell id="yNt7iZRtLh1xZD_xEbhY-21" style="edgeStyle=orthogonalEdgeStyle;curved=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;dashed=1;strokeColor=#000000;" parent="1" source="yNt7iZRtLh1xZD_xEbhY-17" target="yNt7iZRtLh1xZD_xEbhY-22" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="490.3333333333335" y="340" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="yNt7iZRtLh1xZD_xEbhY-17" value="AsyncDispatcher 异步(多线程机制)dispatch RMAppEventType.START事件&amp;nbsp;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="369.38" y="250" width="241.25" height="40" as="geometry" />
        </mxCell>
        <mxCell id="yNt7iZRtLh1xZD_xEbhY-20" value="1.事件中包含了事件类型&lt;br&gt;2.RMAppEvent事件绑定的EventHandler 是 ApplicationEventDispatcher" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="620" y="250" width="430" height="40" as="geometry" />
        </mxCell>
        <mxCell id="yNt7iZRtLh1xZD_xEbhY-23" style="edgeStyle=orthogonalEdgeStyle;curved=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;dashed=1;strokeColor=#000000;" parent="1" source="yNt7iZRtLh1xZD_xEbhY-22" target="yNt7iZRtLh1xZD_xEbhY-24" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="490.3333333333335" y="400" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="yNt7iZRtLh1xZD_xEbhY-22" value="ApplicationEventDispatcher.handle" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="395.01" y="330" width="190" height="20" as="geometry" />
        </mxCell>
        <mxCell id="yNt7iZRtLh1xZD_xEbhY-25" style="edgeStyle=orthogonalEdgeStyle;curved=1;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;strokeColor=#000000;" parent="1" source="yNt7iZRtLh1xZD_xEbhY-24" target="yNt7iZRtLh1xZD_xEbhY-26" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="490.0050000000001" y="440" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="yNt7iZRtLh1xZD_xEbhY-24" value="RMApImpl.handle" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="430.17" y="380" width="119.67" height="20" as="geometry" />
        </mxCell>
        <mxCell id="hI8e0pMCcGRfKH6Qq3i_-4" style="edgeStyle=orthogonalEdgeStyle;curved=1;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;dashed=1;strokeColor=#000000;" edge="1" parent="1" source="yNt7iZRtLh1xZD_xEbhY-26" target="hI8e0pMCcGRfKH6Qq3i_-2">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="yNt7iZRtLh1xZD_xEbhY-26" value="&lt;div&gt;&lt;span&gt;调用 RMAppImpl 内部状态机的 doTransion 方法进行状态转换。&lt;/span&gt;&lt;span&gt;实际调用的 hook：RMAppNewlySavingTransition.transition()&lt;/span&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="369.38" y="440" width="240.01" height="60" as="geometry" />
        </mxCell>
        <mxCell id="yNt7iZRtLh1xZD_xEbhY-27" value="这一步的状态转换：接收RMAppEventType.START 事件&lt;br&gt;状态由：&lt;font color=&quot;#ff0000&quot;&gt;NEW -&amp;gt; NEW_SAVING&lt;/font&gt;，在转换操作中会对当前 RMApp 信息做一次 checkpoint。状态保存也有自己的状态机（RMStateStore）,checkpoint 有四种类型，保存完副本信息之后，会进一步驱动 RMAppImpl 的状态机" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="630" y="430" width="340" height="80" as="geometry" />
        </mxCell>
        <mxCell id="hI8e0pMCcGRfKH6Qq3i_-8" style="edgeStyle=orthogonalEdgeStyle;curved=1;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;strokeColor=#000000;" edge="1" parent="1" source="hI8e0pMCcGRfKH6Qq3i_-2" target="hI8e0pMCcGRfKH6Qq3i_-6">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="hI8e0pMCcGRfKH6Qq3i_-2" value="保存应用信息完成后，继续向AsyncDispatcher 发起APP_NEW_SAVED事件，进一步驱动 RMAppImpl 状态机" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="364.47" y="550" width="249.83" height="70" as="geometry" />
        </mxCell>
        <mxCell id="hI8e0pMCcGRfKH6Qq3i_-9" style="edgeStyle=orthogonalEdgeStyle;curved=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;dashed=1;strokeColor=#000000;" edge="1" parent="1" source="hI8e0pMCcGRfKH6Qq3i_-6" target="hI8e0pMCcGRfKH6Qq3i_-7">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="hI8e0pMCcGRfKH6Qq3i_-6" value="ApplicationEventDispatcher.handle" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="395.01" y="660" width="190" height="20" as="geometry" />
        </mxCell>
        <mxCell id="hI8e0pMCcGRfKH6Qq3i_-12" style="edgeStyle=orthogonalEdgeStyle;curved=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;dashed=1;strokeColor=#000000;" edge="1" parent="1" source="hI8e0pMCcGRfKH6Qq3i_-7" target="hI8e0pMCcGRfKH6Qq3i_-11">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="hI8e0pMCcGRfKH6Qq3i_-7" value="RMApImpl.handle" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="430.18" y="710" width="119.67" height="20" as="geometry" />
        </mxCell>
        <mxCell id="hI8e0pMCcGRfKH6Qq3i_-11" value="&lt;div&gt;&lt;span&gt;调用 RMAppImpl 内部状态机的 doTransion 方法进行状态转换。&lt;/span&gt;&lt;span&gt;实际调用的 hook：&lt;/span&gt;&lt;/div&gt;AddApplicationToSchedulerTransition.transition()" style="rounded=1;whiteSpace=wrap;html=1;align=left;" vertex="1" parent="1">
          <mxGeometry x="345.02" y="770" width="290" height="70" as="geometry" />
        </mxCell>
        <mxCell id="hI8e0pMCcGRfKH6Qq3i_-13" value="这一步的状态转换：接收&lt;span style=&quot;text-align: center&quot;&gt;APP_NEW_SAVED&lt;/span&gt;&amp;nbsp;事件&lt;br&gt;状态由：&lt;font color=&quot;#ff0000&quot;&gt;NEW_SAVING -&amp;gt; SUBMITTED。此时继续&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="665" y="785" width="305" height="40" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="XnYNndNCFGSMYNIC9lYN" name="Page-2">
    <mxGraphModel dx="783" dy="465" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="aZMeeBP6NVpgLK66qUjC-0" />
        <mxCell id="aZMeeBP6NVpgLK66qUjC-1" parent="aZMeeBP6NVpgLK66qUjC-0" />
        <mxCell id="v3Vh2EvOcKdoonj9j3Pa-0" value="" style="endArrow=classic;html=1;dashed=1;strokeColor=#FF0000;curved=1;" edge="1" parent="aZMeeBP6NVpgLK66qUjC-1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="60" y="60" as="sourcePoint" />
            <mxPoint x="170" y="60" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="v3Vh2EvOcKdoonj9j3Pa-1" value="Rpc" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="v3Vh2EvOcKdoonj9j3Pa-0">
          <mxGeometry x="-0.3818" y="2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="v3Vh2EvOcKdoonj9j3Pa-2" style="edgeStyle=orthogonalEdgeStyle;curved=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;dashed=1;strokeColor=#FF0000;" edge="1" parent="aZMeeBP6NVpgLK66qUjC-1" source="v3Vh2EvOcKdoonj9j3Pa-3" target="v3Vh2EvOcKdoonj9j3Pa-5">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="v3Vh2EvOcKdoonj9j3Pa-3" value="Client" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="aZMeeBP6NVpgLK66qUjC-1">
          <mxGeometry x="30" y="455" width="50" height="30" as="geometry" />
        </mxCell>
        <mxCell id="v3Vh2EvOcKdoonj9j3Pa-32" style="edgeStyle=orthogonalEdgeStyle;curved=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;dashed=1;" edge="1" parent="aZMeeBP6NVpgLK66qUjC-1" source="v3Vh2EvOcKdoonj9j3Pa-5" target="v3Vh2EvOcKdoonj9j3Pa-9">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="v3Vh2EvOcKdoonj9j3Pa-5" value="ClientRMService.submitApplication()" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="aZMeeBP6NVpgLK66qUjC-1">
          <mxGeometry x="120" y="453.75" width="200" height="32.5" as="geometry" />
        </mxCell>
        <mxCell id="v3Vh2EvOcKdoonj9j3Pa-6" value="" style="endArrow=classic;html=1;dashed=1;curved=1;" edge="1" parent="aZMeeBP6NVpgLK66qUjC-1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="60" y="80" as="sourcePoint" />
            <mxPoint x="170" y="80" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="v3Vh2EvOcKdoonj9j3Pa-7" value="Local" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="v3Vh2EvOcKdoonj9j3Pa-6">
          <mxGeometry x="-0.3818" y="2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="v3Vh2EvOcKdoonj9j3Pa-45" style="edgeStyle=orthogonalEdgeStyle;curved=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;dashed=1;strokeColor=#000000;" edge="1" parent="aZMeeBP6NVpgLK66qUjC-1" source="v3Vh2EvOcKdoonj9j3Pa-9" target="v3Vh2EvOcKdoonj9j3Pa-43">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="v3Vh2EvOcKdoonj9j3Pa-9" value="RMAppManager.submitApplication()" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="aZMeeBP6NVpgLK66qUjC-1">
          <mxGeometry x="380.01" y="453.75" width="220" height="31.25" as="geometry" />
        </mxCell>
        <mxCell id="v3Vh2EvOcKdoonj9j3Pa-57" style="edgeStyle=orthogonalEdgeStyle;curved=1;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;dashed=1;strokeColor=#000000;" edge="1" parent="aZMeeBP6NVpgLK66qUjC-1" source="v3Vh2EvOcKdoonj9j3Pa-12" target="v3Vh2EvOcKdoonj9j3Pa-52">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="v3Vh2EvOcKdoonj9j3Pa-12" value="&lt;div style=&quot;text-align: left&quot;&gt;&lt;div&gt;1.将该应用放入 Map 集合&lt;/div&gt;&lt;div&gt;2.创建资源请求&lt;/div&gt;&lt;div&gt;3.验证资源请求是否合理&lt;/div&gt;&lt;div&gt;4.内部会创建 RMAppImpl 的状态机，初始状态是 &lt;font color=&quot;#ff0000&quot;&gt;NEW&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;" style="text;html=1;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;dashed=1;strokeColor=#000000;" vertex="1" parent="aZMeeBP6NVpgLK66qUjC-1">
          <mxGeometry x="679.9200000000001" y="250" width="320.16" height="60" as="geometry" />
        </mxCell>
        <mxCell id="v3Vh2EvOcKdoonj9j3Pa-22" value="接收：RMAppEventType.START 事件&lt;br&gt;状态：&lt;font color=&quot;#ff0000&quot;&gt;NEW -&amp;gt; NEW_SAVING&lt;/font&gt;" style="text;html=1;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;strokeColor=#000000;dashed=1;" vertex="1" parent="aZMeeBP6NVpgLK66qUjC-1">
          <mxGeometry x="1132.49" y="810" width="207.51" height="40" as="geometry" />
        </mxCell>
        <mxCell id="v3Vh2EvOcKdoonj9j3Pa-30" value="接收：&lt;span style=&quot;text-align: center&quot;&gt;APP_NEW_SAVED&lt;/span&gt;&amp;nbsp;事件&lt;br&gt;状态：&lt;font color=&quot;#ff0000&quot;&gt;NEW_SAVING -&amp;gt; SUBMITTED&lt;/font&gt;" style="text;html=1;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;strokeColor=#000000;dashed=1;" vertex="1" parent="aZMeeBP6NVpgLK66qUjC-1">
          <mxGeometry x="1153.75" y="1045" width="225" height="40" as="geometry" />
        </mxCell>
        <mxCell id="v3Vh2EvOcKdoonj9j3Pa-15" value="1.用事件包装事件类型&lt;br&gt;2.RMAppEvent事件绑定的EventHandler 是 ApplicationEventDispatcher&lt;br&gt;3.this.rmContext.getDispatcher()得到的是一个 RM 全局的异步(队列+线程)事件分发器。" style="text;html=1;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;strokeColor=#000000;dashed=1;" vertex="1" parent="aZMeeBP6NVpgLK66qUjC-1">
          <mxGeometry x="844.99" y="470" width="470" height="55" as="geometry" />
        </mxCell>
        <mxCell id="v3Vh2EvOcKdoonj9j3Pa-43" value="" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;shadow=1;glass=1;" vertex="1" parent="aZMeeBP6NVpgLK66qUjC-1">
          <mxGeometry x="640" y="345" width="20" height="250" as="geometry" />
        </mxCell>
        <mxCell id="v3Vh2EvOcKdoonj9j3Pa-52" value="1.RMAppImpl application = createAndPopulateNewRMApp()&amp;nbsp;" style="rounded=0;whiteSpace=wrap;html=1;shadow=0;glass=0;align=left;" vertex="1" parent="aZMeeBP6NVpgLK66qUjC-1">
          <mxGeometry x="670" y="360" width="340" height="40" as="geometry" />
        </mxCell>
        <mxCell id="lRH3pvCeXeyjdBcsUGSI-4" style="edgeStyle=orthogonalEdgeStyle;curved=1;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;strokeColor=#000000;" edge="1" parent="aZMeeBP6NVpgLK66qUjC-1" source="v3Vh2EvOcKdoonj9j3Pa-55" target="lRH3pvCeXeyjdBcsUGSI-3">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="v3Vh2EvOcKdoonj9j3Pa-55" value="2.&amp;nbsp;this.rmContext.getDispatcher().getEventHandler() .handle(new RMAppEvent(applicationId, RMAppEventType.START))" style="rounded=0;whiteSpace=wrap;html=1;shadow=0;glass=0;align=left;" vertex="1" parent="aZMeeBP6NVpgLK66qUjC-1">
          <mxGeometry x="664.99" y="540" width="650" height="40" as="geometry" />
        </mxCell>
        <mxCell id="lRH3pvCeXeyjdBcsUGSI-7" style="edgeStyle=orthogonalEdgeStyle;curved=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;dashed=1;strokeColor=#000000;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="aZMeeBP6NVpgLK66qUjC-1" source="lRH3pvCeXeyjdBcsUGSI-3" target="lRH3pvCeXeyjdBcsUGSI-8">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="990" y="680" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="lRH3pvCeXeyjdBcsUGSI-3" value="&lt;span style=&quot;text-align: left&quot;&gt;ApplicationEventDispatcher.handle(&lt;/span&gt;&lt;span style=&quot;text-align: left&quot;&gt;new RMAppEvent(applicationId, RMAppEventType.START)&lt;/span&gt;&lt;span style=&quot;text-align: left&quot;&gt;&lt;br&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;shadow=0;glass=0;strokeColor=#000000;" vertex="1" parent="aZMeeBP6NVpgLK66qUjC-1">
          <mxGeometry x="734.99" y="620" width="510.01" height="30" as="geometry" />
        </mxCell>
        <mxCell id="lRH3pvCeXeyjdBcsUGSI-10" style="edgeStyle=orthogonalEdgeStyle;curved=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;dashed=1;strokeColor=#000000;" edge="1" parent="aZMeeBP6NVpgLK66qUjC-1" source="lRH3pvCeXeyjdBcsUGSI-8" target="lRH3pvCeXeyjdBcsUGSI-9">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="lRH3pvCeXeyjdBcsUGSI-8" value="RMApImpl.handle(&lt;span style=&quot;text-align: left&quot;&gt;new RMAppEvent(applicationId, RMAppEventType.START)&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="aZMeeBP6NVpgLK66qUjC-1">
          <mxGeometry x="774.99" y="690" width="430" height="30" as="geometry" />
        </mxCell>
        <mxCell id="lRH3pvCeXeyjdBcsUGSI-13" style="edgeStyle=orthogonalEdgeStyle;curved=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;dashed=1;strokeColor=#000000;" edge="1" parent="aZMeeBP6NVpgLK66qUjC-1" source="lRH3pvCeXeyjdBcsUGSI-9" target="lRH3pvCeXeyjdBcsUGSI-11">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="lRH3pvCeXeyjdBcsUGSI-9" value="RMApImpl.stateMachine.doTransition(event.getType(), event)" style="rounded=1;whiteSpace=wrap;html=1;shadow=0;glass=0;strokeColor=#000000;" vertex="1" parent="aZMeeBP6NVpgLK66qUjC-1">
          <mxGeometry x="817.48" y="750" width="345.01" height="30" as="geometry" />
        </mxCell>
        <mxCell id="lRH3pvCeXeyjdBcsUGSI-15" style="edgeStyle=orthogonalEdgeStyle;curved=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;dashed=1;strokeColor=#000000;" edge="1" parent="aZMeeBP6NVpgLK66qUjC-1" source="lRH3pvCeXeyjdBcsUGSI-11" target="lRH3pvCeXeyjdBcsUGSI-14">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="lRH3pvCeXeyjdBcsUGSI-11" value="RMAppNewlySavingTransition.transition()" style="rounded=1;whiteSpace=wrap;html=1;shadow=0;glass=0;strokeColor=#000000;" vertex="1" parent="aZMeeBP6NVpgLK66qUjC-1">
          <mxGeometry x="869.99" y="815" width="240" height="30" as="geometry" />
        </mxCell>
        <mxCell id="lRH3pvCeXeyjdBcsUGSI-19" style="edgeStyle=orthogonalEdgeStyle;curved=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.467;entryY=0.025;entryDx=0;entryDy=0;entryPerimeter=0;dashed=1;strokeColor=#000000;" edge="1" parent="aZMeeBP6NVpgLK66qUjC-1" source="lRH3pvCeXeyjdBcsUGSI-14" target="lRH3pvCeXeyjdBcsUGSI-18">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="lRH3pvCeXeyjdBcsUGSI-20" value="发出&lt;span style=&quot;font-size: 12px ; text-align: left ; background-color: rgb(248 , 249 , 250)&quot;&gt;RMAppEventType APP_NEW_SAVED事件&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="lRH3pvCeXeyjdBcsUGSI-19">
          <mxGeometry x="-0.3258" y="1" relative="1" as="geometry">
            <mxPoint x="-1.01" y="9" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="lRH3pvCeXeyjdBcsUGSI-14" value="app.rmContext.getStateStore().storeNewApplication(app)" style="rounded=1;whiteSpace=wrap;html=1;shadow=0;glass=0;strokeColor=#000000;" vertex="1" parent="aZMeeBP6NVpgLK66qUjC-1">
          <mxGeometry x="826.23" y="880" width="327.52" height="30" as="geometry" />
        </mxCell>
        <mxCell id="lRH3pvCeXeyjdBcsUGSI-16" value="1.对 App 信息做 CheckPoint，用于恢复应用(有四种方式，有自己对应的状态机)&lt;br&gt;2.操作完成之后，向全局事件分发器发出RMAppEventType APP_NEW_SAVED事件" style="text;html=1;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;shadow=0;glass=0;strokeColor=#000000;dashed=1;" vertex="1" parent="aZMeeBP6NVpgLK66qUjC-1">
          <mxGeometry x="1170" y="875" width="460" height="40" as="geometry" />
        </mxCell>
        <mxCell id="lRH3pvCeXeyjdBcsUGSI-23" style="edgeStyle=orthogonalEdgeStyle;curved=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;dashed=1;strokeColor=#000000;" edge="1" parent="aZMeeBP6NVpgLK66qUjC-1" source="lRH3pvCeXeyjdBcsUGSI-18" target="lRH3pvCeXeyjdBcsUGSI-22">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="lRH3pvCeXeyjdBcsUGSI-18" value="进一步驱动RMAppImpl 状态机" style="rounded=1;whiteSpace=wrap;html=1;shadow=0;glass=0;strokeColor=#000000;" vertex="1" parent="aZMeeBP6NVpgLK66qUjC-1">
          <mxGeometry x="904.99" y="980" width="170" height="30" as="geometry" />
        </mxCell>
        <mxCell id="lRH3pvCeXeyjdBcsUGSI-25" style="edgeStyle=orthogonalEdgeStyle;curved=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;dashed=1;strokeColor=#000000;" edge="1" parent="aZMeeBP6NVpgLK66qUjC-1" source="lRH3pvCeXeyjdBcsUGSI-22" target="lRH3pvCeXeyjdBcsUGSI-24">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="lRH3pvCeXeyjdBcsUGSI-22" value="&lt;span style=&quot;text-align: left&quot;&gt;AddApplicationToSchedulerTransition.transition()&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;shadow=0;glass=0;strokeColor=#000000;" vertex="1" parent="aZMeeBP6NVpgLK66qUjC-1">
          <mxGeometry x="849.99" y="1050" width="280.01" height="30" as="geometry" />
        </mxCell>
        <mxCell id="lRH3pvCeXeyjdBcsUGSI-28" style="edgeStyle=orthogonalEdgeStyle;curved=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;dashed=1;strokeColor=#000000;" edge="1" parent="aZMeeBP6NVpgLK66qUjC-1" source="lRH3pvCeXeyjdBcsUGSI-24" target="lRH3pvCeXeyjdBcsUGSI-27">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="lRH3pvCeXeyjdBcsUGSI-24" value="app.handler.handle(new AppAddedSchedulerEvent())" style="rounded=1;whiteSpace=wrap;html=1;shadow=0;glass=0;strokeColor=#000000;" vertex="1" parent="aZMeeBP6NVpgLK66qUjC-1">
          <mxGeometry x="839.99" y="1129" width="300" height="40" as="geometry" />
        </mxCell>
        <mxCell id="lRH3pvCeXeyjdBcsUGSI-26" value="1. AppAddedSchedulerEvent实际内部是SchedulerEventType.APP_ADDED类型&lt;br&gt;2. SchedulerEvent与SchedulerEventDispatcher绑定&lt;br&gt;3.&amp;nbsp;&lt;font color=&quot;#ff0000&quot;&gt;SchedulerEventDispatcher类似全局 dispatcher(队列+线程)&lt;/font&gt;" style="text;html=1;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;shadow=0;glass=0;strokeColor=#000000;dashed=1;" vertex="1" parent="aZMeeBP6NVpgLK66qUjC-1">
          <mxGeometry x="1162.49" y="1119" width="447.51" height="50" as="geometry" />
        </mxCell>
        <mxCell id="lRH3pvCeXeyjdBcsUGSI-37" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;strokeColor=#000000;" edge="1" parent="aZMeeBP6NVpgLK66qUjC-1" source="lRH3pvCeXeyjdBcsUGSI-27" target="lRH3pvCeXeyjdBcsUGSI-30">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="lRH3pvCeXeyjdBcsUGSI-27" value="ResourceScheduler.handle(&lt;span style=&quot;text-align: left&quot;&gt;SchedulerEvent-&lt;/span&gt;&lt;span style=&quot;text-align: left&quot;&gt;SchedulerEventType.APP_ADDED&lt;/span&gt;)" style="rounded=1;whiteSpace=wrap;html=1;shadow=0;glass=0;strokeColor=#000000;" vertex="1" parent="aZMeeBP6NVpgLK66qUjC-1">
          <mxGeometry x="779.98" y="1215" width="420.02" height="40" as="geometry" />
        </mxCell>
        <mxCell id="lRH3pvCeXeyjdBcsUGSI-40" style="edgeStyle=orthogonalEdgeStyle;curved=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0.1;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;dashed=1;strokeColor=#000000;" edge="1" parent="aZMeeBP6NVpgLK66qUjC-1" source="lRH3pvCeXeyjdBcsUGSI-30" target="lRH3pvCeXeyjdBcsUGSI-31">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="lRH3pvCeXeyjdBcsUGSI-30" value="比如：FifoScheduler.handle()" style="text;html=1;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=1;shadow=0;glass=0;strokeColor=#000000;" vertex="1" parent="aZMeeBP6NVpgLK66qUjC-1">
          <mxGeometry x="1245" y="1215" width="170" height="40" as="geometry" />
        </mxCell>
        <mxCell id="lRH3pvCeXeyjdBcsUGSI-31" value="" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;shadow=1;glass=1;size=0.25;" vertex="1" parent="aZMeeBP6NVpgLK66qUjC-1">
          <mxGeometry x="1450" y="1200" width="15" height="70" as="geometry" />
        </mxCell>
        <mxCell id="lRH3pvCeXeyjdBcsUGSI-35" value="1. application=new SchedulerApplication&amp;lt;FiCaSchedulerApp&amp;gt; (DEFAULT QUEUE user)" style="rounded=0;whiteSpace=wrap;html=1;shadow=0;glass=0;strokeColor=#000000;align=left;" vertex="1" parent="aZMeeBP6NVpgLK66qUjC-1">
          <mxGeometry x="1475" y="1200" width="495" height="30" as="geometry" />
        </mxCell>
        <mxCell id="lRH3pvCeXeyjdBcsUGSI-42" style="edgeStyle=orthogonalEdgeStyle;curved=1;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;strokeColor=#000000;" edge="1" parent="aZMeeBP6NVpgLK66qUjC-1" source="lRH3pvCeXeyjdBcsUGSI-36" target="lRH3pvCeXeyjdBcsUGSI-41">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="lRH3pvCeXeyjdBcsUGSI-36" value="2. rmContext.getDispatcher().getEventHandler().handle(new RMAppEvent(applicationId,RMAppEventType.APP_ACCEPTED))" style="rounded=0;whiteSpace=wrap;html=1;shadow=0;glass=0;strokeColor=#000000;align=left;" vertex="1" parent="aZMeeBP6NVpgLK66qUjC-1">
          <mxGeometry x="1475" y="1240" width="685" height="30" as="geometry" />
        </mxCell>
        <mxCell id="lRH3pvCeXeyjdBcsUGSI-46" style="edgeStyle=orthogonalEdgeStyle;curved=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;dashed=1;strokeColor=#000000;" edge="1" parent="aZMeeBP6NVpgLK66qUjC-1" source="lRH3pvCeXeyjdBcsUGSI-41" target="lRH3pvCeXeyjdBcsUGSI-45">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="lRH3pvCeXeyjdBcsUGSI-41" value="StartApAtemptTransition.transition()" style="rounded=1;whiteSpace=wrap;html=1;shadow=0;glass=0;strokeColor=#000000;" vertex="1" parent="aZMeeBP6NVpgLK66qUjC-1">
          <mxGeometry x="1707.5" y="1310" width="220" height="30" as="geometry" />
        </mxCell>
        <mxCell id="lRH3pvCeXeyjdBcsUGSI-44" value="接收：APP_ACCEPTED&amp;nbsp;事件&lt;br&gt;状态：&lt;font color=&quot;#ff0000&quot;&gt;SUBMITTED -&amp;gt;&amp;nbsp;ACCEPTED&lt;/font&gt;" style="text;html=1;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;strokeColor=#000000;dashed=1;" vertex="1" parent="aZMeeBP6NVpgLK66qUjC-1">
          <mxGeometry x="1950" y="1305" width="225" height="40" as="geometry" />
        </mxCell>
        <mxCell id="lRH3pvCeXeyjdBcsUGSI-48" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;strokeColor=#000000;" edge="1" parent="aZMeeBP6NVpgLK66qUjC-1" source="lRH3pvCeXeyjdBcsUGSI-45" target="lRH3pvCeXeyjdBcsUGSI-47">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="lRH3pvCeXeyjdBcsUGSI-45" value="app.createAndStartNewAttempt(false)" style="rounded=1;whiteSpace=wrap;html=1;shadow=0;glass=0;strokeColor=#000000;" vertex="1" parent="aZMeeBP6NVpgLK66qUjC-1">
          <mxGeometry x="1710.75" y="1430" width="213.5" height="40" as="geometry" />
        </mxCell>
        <mxCell id="lRH3pvCeXeyjdBcsUGSI-47" value="" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;shadow=1;glass=1;size=0.25;" vertex="1" parent="aZMeeBP6NVpgLK66qUjC-1">
          <mxGeometry x="1970" y="1415" width="15" height="70" as="geometry" />
        </mxCell>
        <mxCell id="lRH3pvCeXeyjdBcsUGSI-49" value="1. createNewAttempt()" style="rounded=0;whiteSpace=wrap;html=1;shadow=0;glass=0;strokeColor=#000000;align=left;" vertex="1" parent="aZMeeBP6NVpgLK66qUjC-1">
          <mxGeometry x="1985" y="1415" width="132" height="30" as="geometry" />
        </mxCell>
        <mxCell id="lRH3pvCeXeyjdBcsUGSI-51" value="2.&amp;nbsp;handler.handle(new RMAppStartAttemptEvent())" style="rounded=0;whiteSpace=wrap;html=1;shadow=0;glass=0;strokeColor=#000000;align=left;" vertex="1" parent="aZMeeBP6NVpgLK66qUjC-1">
          <mxGeometry x="1985" y="1455" width="275" height="30" as="geometry" />
        </mxCell>
        <mxCell id="lRH3pvCeXeyjdBcsUGSI-52" value="1. new RMAppAttemptImpl&lt;br&gt;2. RMAppAttemptImpl也有自己的状态机" style="text;html=1;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;shadow=0;glass=0;strokeColor=#000000;dashed=1;" vertex="1" parent="aZMeeBP6NVpgLK66qUjC-1">
          <mxGeometry x="2130" y="1415" width="230" height="30" as="geometry" />
        </mxCell>
        <mxCell id="lRH3pvCeXeyjdBcsUGSI-54" value="1. RMAppStartAttemptEvent内部实际是RMAppAttemptEventType.START事件&amp;nbsp; &amp;nbsp;" style="text;html=1;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;shadow=0;glass=0;strokeColor=#000000;dashed=1;" vertex="1" parent="aZMeeBP6NVpgLK66qUjC-1">
          <mxGeometry x="2270" y="1455" width="430" height="30" as="geometry" />
        </mxCell>
        <mxCell id="lRH3pvCeXeyjdBcsUGSI-55" value="当 AM 启动之后，会想 ams 进行注册，注册的时候 RMApp 会进入 RUNNING 状态" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;shadow=0;glass=0;dashed=1;" vertex="1" parent="aZMeeBP6NVpgLK66qUjC-1">
          <mxGeometry x="2190" y="1550" width="300" height="60" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
